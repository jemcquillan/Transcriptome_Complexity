edata_ortho_dros <- getEventData(drosophila_tre, eventdata = "drosophila_ortho_mean_EpT_event_data.txt", type = "trait", burnin = 0.1)
plot.bammdata(edata_WT_deut, labels = TRUE, legend = TRUE, color.interval = c(0,1))
plot.bammdata(edata_WT_deut, labels = TRUE, legend = TRUE, color.interval = c(0,1))
#Analysis of rate shifts in the BAMM framework (WT)
#Marginal shift probabilities
deuterostome_tre <- read.tree("Deuterostome_Species_TimeTree_no_polytomy.tre")
setwd("/Volumes/GoogleDrive/My\ Drive/OrthoDB/Ortholog_Final_Files/Deuterostome_Complexity/Deuterostome_tree/Deuterostome_BAMM_Analysis")
#Sanity check for mcmc convergence
#Convergence WT
mcmcout <- read.csv("deuterostome_WT_mean_EpT_mcmc_out.txt", header=T)
plot(mcmcout$logLik ~ mcmcout$generation)
burnstart <- floor(0.1 * nrow(mcmcout))
postburn <- mcmcout[burnstart:nrow(mcmcout), ]
effectiveSize(postburn$N_shifts)
effectiveSize(postburn$logLik)
#Convergence ortholog
ortho_mcmcout <- read.csv("deuterostome_ortho_mean_EpT_mcmc_out.txt", header=T)
plot(ortho_mcmcout$logLik ~ ortho_mcmcout$generation)
ortho_burnstart <- floor(0.1 * nrow(ortho_mcmcout))
ortho_postburn <- ortho_mcmcout[burnstart:nrow(ortho_mcmcout), ]
effectiveSize(ortho_postburn$N_shifts)
effectiveSize(ortho_postburn$logLik)
#Analysis of rate shifts in the BAMM framework (WT)
#Marginal shift probabilities
deuterostome_tre <- read.tree("Deuterostome_Species_TimeTree_no_polytomy.tre")
edata_WT_deut <- getEventData(deuterostome_tre, eventdata = "deuterostome_WT_mean_EpT_event_data.txt", type = "trait", burnin = 0.1)
marg_probs_WT_deut <- marginalShiftProbsTree(edata_WT_deut)
plot.phylo(marg_probs_WT_deut)
plot.bammdata(edata_WT_deut, labels = TRUE, legend = TRUE, color.interval = c(0,1))
plot.bammdata(edata_ortho_deut, labels = TRUE,legend = TRUE, color.interval = c(0,1), direction = "leftwards")
edata_ortho_deut <- getEventData(deuterostome_tre, eventdata = "deuterostome_ortho_mean_EpT_event_data.txt", type = "trait", burnin = 0.1)
marg_probs_ortho_deut <- marginalShiftProbsTree(edata_ortho_deut)
plot.bammdata(edata_ortho_deut, labels = TRUE,legend = TRUE, color.interval = c(0,1), direction = "leftwards")
plot.bammdata(edata_WT_dros, labels = TRUE, legend = TRUE, color.interval = c(0,1))
plot.bammdata(edata_WT_deut, labels = TRUE, legend = TRUE, color.interval = c(.15,1))
plot.bammdata(edata_WT_deut, labels = TRUE, legend = TRUE, color.interval = c(.21,1))
plot.bammdata(edata_WT_deut, labels = TRUE, legend = TRUE, color.interval = c(0,.25))
plot.bammdata(edata_WT_deut, labels = TRUE, legend = TRUE) #color.interval = c(0,.25))
setwd("/Volumes/GoogleDrive/My Drive/OrthoDB/Ortholog_Final_Files/Plantae_Complexity/Plantae_tree/Plantae_BAMM_Analysis")
#Sanity check for mcmc convergence
#Convergence WT
mcmcout <- read.csv("plantae_WT_mean_EpT_mcmc_out.txt", header=T)
plot(mcmcout$logLik ~ mcmcout$generation)
burnstart <- floor(0.1 * nrow(mcmcout))
postburn <- mcmcout[burnstart:nrow(mcmcout), ]
effectiveSize(postburn$N_shifts)
effectiveSize(postburn$logLik)
#Convergence ortholog
ortho_mcmcout <- read.csv("drosophila_ortho_mcmc_out.txt", header=T)
#Sanity check for mcmc convergence
#Convergence WT
mcmcout <- read.csv("plantae_WT_mean_EpT_mcmc_out.txt", header=T)
plot(mcmcout$logLik ~ mcmcout$generation)
burnstart <- floor(0.1 * nrow(mcmcout))
postburn <- mcmcout[burnstart:nrow(mcmcout), ]
effectiveSize(postburn$N_shifts)
effectiveSize(postburn$logLik)
#Convergence ortholog
ortho_mcmcout <- read.csv("plantae_ortho_mean_EpT_mcmc_out.txt", header=T)
plot(ortho_mcmcout$logLik ~ ortho_mcmcout$generation)
ortho_burnstart <- floor(0.1 * nrow(ortho_mcmcout))
?plot
effectiveSize(ortho_postburn$N_shifts)
effectiveSize(ortho_postburn$logLik)
#Analysis of rate shifts in the BAMM framework (WT)
#Marginal shift probabilities
plantae_tre <- read.tree("Plantae_Species_Tree_list_no_polytomy.tre")
edata_WT_plant <- getEventData(plantae_tre, eventdata = "plantae_WT_event_data.txt", type = "trait", burnin = 0.1)
edata_WT_plant <- getEventData(plantae_tre, eventdata = "plantae_WT_mean_EpT_event_data.txt", type = "trait", burnin = 0.1)
marg_probs_WT_plant <- marginalShiftProbsTree(edata_WT_plant)
plot.phylo(marg_probs_WT_plant)
plot.bammdata(edata_WT_plant, labels = TRUE, legend = TRUE)
#Analysis of rate shifts in the BAMM framework (Orthologs)
#Marginal shift probabilities
plantae_tre <- read.tree("plantae_Species_TimeTree_no_polytomy.tre")
edata_ortho_plant <- getEventData(plantae_tre, eventdata = "plantae_ortho_event_data.txt", type = "trait", burnin = 0.1)
edata_ortho_plant <- getEventData(plantae_tre, eventdata = "plantae_ortho_mean_EpT_event_data.txt", type = "trait", burnin = 0.1)
marg_probs_ortho_plant <- marginalShiftProbsTree(edata_ortho_plant)
plot.phylo(marg_probs_ortho_plant)
plot.bammdata(edata_ortho_plant, labels = TRUE,legend = TRUE, color.interval = c(0,0.9))
##################
plantae_tre <- read.tree("plantae_Species_TimeTree_no_polytomy.tre")
setwd("/Volumes/GoogleDrive/My Drive/OrthoDB/Ortholog_Final_Files/Plantae_Complexity/Plantae_tree/Plantae_BAMM_Analysis")
#Analysis of rate shifts in the BAMM framework (Orthologs)
#Marginal shift probabilities
plantae_tre <- read.tree("plantae_Species_TimeTree_no_polytomy.tre")
##################
plantae_tre <- read.tree("plantae_Species_TimeTree_no_polytomy.tre")
#Analysis of rate shifts in the BAMM framework (Orthologs)
#Marginal shift probabilities
plantae_tre <- read.tree("plantae_Species_TimeTree_no_polytomy.tre")
#Analysis of rate shifts in the BAMM framework (WT)
#Marginal shift probabilities
plantae_tre <- read.tree("Plantae_Species_Tree_list_no_polytomy.tre")
##################
plantae_tre <- read.tree("Plantae_Species_Tree_list_no_polytomy.tre")
deut_Shift_Config <- distinctShiftConfigurations(plantae_edata, expectedNumberOfShifts = 1, threshold = 5)
plantae_edata <- getEventData(plantae_tre, eventdata = "plantae_event_data.txt", type = "trait", burnin = 0.25)
edata_ortho_plant <- getEventData(plantae_tre, eventdata = "plantae_WT_mean_EpT_event_data.txt", type = "trait", burnin = 0.1)
deut_Shift_Config <- distinctShiftConfigurations(edata_WT_plant, expectedNumberOfShifts = 1, threshold = 5)
deut_css <- credibleShiftSet(edata_plant, expectedNumberOfShifts = 1, threshold = 5)
plot.bammshifts(x = deut_Shift_Config, ephy = plantae_edata)
deut_Shift_Config <- distinctShiftConfigurations(edata_WT_plant, expectedNumberOfShifts = 1, threshold = 5)
deut_css <- credibleShiftSet(plantae_edata, expectedNumberOfShifts = 1, threshold = 5)
plantae_edata <- getEventData(plantae_tre, eventdata = "plantae_WT_mean_EpT_event_data.txt", type = "trait", burnin = 0.25)
deut_Shift_Config <- distinctShiftConfigurations(edata_WT_plant, expectedNumberOfShifts = 1, threshold = 5)
deut_css <- credibleShiftSet(edata_WT_plant, expectedNumberOfShifts = 1, threshold = 5)
plot.bammshifts(x = deut_Shift_Config, ephy = plantae_edata)
deut_Best_Shift_Config <- getBestShiftConfiguration(deut_css)
plot.credibleshiftset(x = deut_css)
plant_marg_probs <- marginalOddsRatioBranches(ephy = edata_ortho_plant,expectedNumberOfShifts = 1)
plot.credibleshiftset(x = deut_css)
plot.bammdata(edata_WT_plant, labels = TRUE, legend = TRUE)
dev.off()
plot.bammdata(edata_WT_plant, labels = TRUE, legend = TRUE)
plot.credibleshiftset(x = plant_css)
plant_css <- credibleShiftSet(edata_WT_plant, expectedNumberOfShifts = 1, threshold = 5)
plot.credibleshiftset(x = plant_css)
dev.off()
setwd("/Volumes/GoogleDrive/My Drive/OrthoDB/Ortholog_Final_Files/Fungi_Complexity/Fungi_tree/Fungi_BAMM_Analysis")
setwd("/Volumes/GoogleDrive/My Drive/OrthoDB/Ortholog_Final_Files/Fungi_Complexity/Fungi_tree/Fungi_BAMM_Analysis")
#Sanity check for mcmc convergence
#Convergence WT
mcmcout <- read.csv("fungi_WT_mean_EpT_mcmc_out.txt", header=T)
plot(mcmcout$logLik ~ mcmcout$generation)
burnstart <- floor(0.1 * nrow(mcmcout))
postburn <- mcmcout[burnstart:nrow(mcmcout), ]
effectiveSize(postburn$N_shifts)
effectiveSize(postburn$logLik)
#Convergence ortholog
ortho_mcmcout <- read.csv("fungi_ortho_mean_EpT_mcmc_out.txt", header=T)
plot(ortho_mcmcout$logLik ~ ortho_mcmcout$generation)
ortho_burnstart <- floor(0.1 * nrow(ortho_mcmcout))
ortho_postburn <- ortho_mcmcout[burnstart:nrow(ortho_mcmcout), ]
effectiveSize(ortho_postburn$N_shifts)
effectiveSize(ortho_postburn$logLik)
#Analysis of rate shifts in the BAMM framework (WT)
#Marginal shift probabilities
fungi_tre <- read.tree("fungi_Species_Tree_list_no_polytomy.tre")
#Convergence ortholog
ortho_mcmcout <- read.csv("fungi_ortho_mean_EpT_mcmc_out.txt", header=T)
plot(ortho_mcmcout$logLik ~ ortho_mcmcout$generation)
ortho_burnstart <- floor(0.1 * nrow(ortho_mcmcout))
ortho_postburn <- ortho_mcmcout[burnstart:nrow(ortho_mcmcout), ]
effectiveSize(ortho_postburn$N_shifts)
effectiveSize(ortho_postburn$logLik)
#Analysis of rate shifts in the BAMM framework (WT)
#Marginal shift probabilities
fungi_tre <- read.tree("fungi_class_pruned_no_polytomy.tre")
edata_WT_fungi <- getEventData(fungi_tre, eventdata = "fungi_WT_mean_EpT_event_data.txt", type = "trait", burnin = 0.1)
marg_probs_WT_fungi <- marginalShiftProbsTree(edata_WT_fungi)
plot.phylo(marg_probs_WT_fungi)
plot.bammdata(edata_WT_fungi, labels = TRUE, legend = TRUE)
fungi_WT_css <- credibleShiftSet(edata_WT_fungi, expectedNumberOfShifts = 1, threshold = 5)
plot.credibleshiftset(x = fungi_css)
plot.credibleshiftset(x = fungi_WT_css)
dev.off()
plot.bammdata(edata_WT_fungi, labels = TRUE, legend = TRUE)
#Analysis of rate shifts in the BAMM framework (Orthologs)
#Marginal shift probabilities
fungi_tre <- read.tree("fungi_class_pruned_no_polytomy.tre")
edata_ortho_fungi <- getEventData(fungi_tre, eventdata = "fungi_WT_mean_EpT_event_data.txt", type = "trait", burnin = 0.1)
marg_probs_ortho_fungi <- marginalShiftProbsTree(edata_ortho_fungi)
plot.phylo(marg_probs_ortho_fungi)
plot.bammdata(edata_ortho_fungi, labels = TRUE,legend = TRUE, color.interval = c(0,0.9))
cmat_deut_WT <- getCohortMatrix(edata_WT_deut)
cohorts(cmat_deut_WT, edata_WT_deut, lwd=3, pal="temperature", use.plot.bammdata=TRUE)
plot.bammdata(edata_WT_deut, labels = TRUE, legend = TRUE, lwd = 3) #color.interval = c(0,.25))
Cladewise(deuterostome_tre, nTip = NTip(deuterostome_tre), edge = deuterostome_tre[["edge"]])
#Analysis of rate shifts in the BAMM framework (WT)
#Marginal shift probabilities
deuterostome_tre <- read.tree("Deuterostome_Species_TimeTree_no_polytomy.tre")
setwd("/Volumes/GoogleDrive/My\ Drive/OrthoDB/Ortholog_Final_Files/Deuterostome_Complexity/Deuterostome_tree/Deuterostome_BAMM_Analysis")
#Analysis of rate shifts in the BAMM framework (WT)
#Marginal shift probabilities
deuterostome_tre <- read.tree("Deuterostome_Species_TimeTree_no_polytomy.tre")
ladderize(deuterostome_tre, right = TRUE)
edata_WT_deut <- getEventData(deuterostome_tre, eventdata = "deuterostome_WT_mean_EpT_event_data.txt", type = "trait", burnin = 0.1)
plot.bammdata(edata_WT_deut, labels = TRUE, legend = TRUE, lwd = 3) #color.interval = c(0,.25))
plot.phylo(deuterostome_tre)
ladderize(deuterostome_tre, right = TRUE)
plot(ladderize(deuterostome_tre, right = TRUE))
ladderize(deuterostome_tre, right = TRUE)
plot(deuterostome_tre)
ladder <- ladderize(deuterostome_tre, right = TRUE)
plot(ladder)
#Analysis of rate shifts in the BAMM framework (WT)
#Marginal shift probabilities
deuterostome_tre <- read.tree("Deuterostome_Species_TimeTree_no_polytomy.tre")
deuterostome_ladder_tree <- ladderize(deuterostome_tre, right = TRUE)
edata_WT_deut <- getEventData(deuterostome_ladder_tree, eventdata = "deuterostome_WT_mean_EpT_event_data.txt", type = "trait", burnin = 0.1)
plot.bammdata(edata_WT_deut, labels = TRUE, legend = TRUE, lwd = 3) #color.interval = c(0,.25))
library(viridis)
plot.bammdata(edata_WT_deut, labels = TRUE, legend = TRUE, lwd = 3, pal = viridis()) #color.interval = c(0,.25))
plot.bammdata(edata_WT_deut, labels = TRUE, legend = TRUE, lwd = 3, pal = viridis #color.interval = c(0,.25))
plot.bammdata(edata_WT_deut, labels = TRUE, legend = TRUE, lwd = 3, pal = viridis) #color.interval = c(0,.25))
plot.bammdata(edata_WT_deut, labels = TRUE, legend = TRUE, lwd = 3, pal = viridis) #color.interval = c(0,.25))
?viridis_pal
color_palette <- viridis_pal(alpha = 1, begin = 0, end = 1, direction = 1, option = "D")
plot.bammdata(edata_WT_deut, labels = TRUE, legend = TRUE, lwd = 3, pal = color_palette) #color.interval = c(0,.25))
plot.bammdata(edata_WT_deut, labels = TRUE, legend = TRUE, lwd = 3, color.palette = viridis) #color.interval = c(0,.25))
plot.bammdata(edata_WT_deut, labels = TRUE, legend = TRUE, lwd = 3, pal = scale_fill_viridis()) #color.interval = c(0,.25))
setwd("/Volumes/GoogleDrive/My\ Drive/OrthoDB/Ortholog_Final_Files/Deuterostome_Complexity/Deuterostome_tree/Deuterostome_BAMM_Analysis")
#Sanity check for mcmc convergence
#Convergence WT
mcmcout <- read.csv("deuterostome_WT_mean_EpT_mcmc_out.txt", header=T)
burnstart <- floor(0.1 * nrow(mcmcout))
postburn <- mcmcout[burnstart:nrow(mcmcout), ]
effectiveSize(postburn$N_shifts)
effectiveSize(postburn$logLik)
#Convergence ortholog
ortho_mcmcout <- read.csv("deuterostome_ortho_mean_EpT_mcmc_out.txt", header=T)
plot(ortho_mcmcout$logLik ~ ortho_mcmcout$generation)
ortho_burnstart <- floor(0.1 * nrow(ortho_mcmcout))
ortho_postburn <- ortho_mcmcout[burnstart:nrow(ortho_mcmcout), ]
effectiveSize(ortho_postburn$N_shifts)
effectiveSize(ortho_postburn$logLik)
#Analysis of rate shifts in the BAMM framework (WT)
#Marginal shift probabilities
deuterostome_tre <- read.tree("Deuterostome_Species_TimeTree_no_polytomy.tre")
deuterostome_ladder_tree <- ladderize(deuterostome_tre, right = TRUE)
plot.bammdata(edata_WT_deut, labels = TRUE, legend = TRUE, lwd = 3, pal = viridis(15)) #color.interval = c(0,.25))
plot.bammdata(edata_WT_deut, labels = TRUE, legend = TRUE, lwd = 3, pal = viridis(15), color.interval = c(0,.1))
plot.bammdata(edata_WT_deut, labels = TRUE, legend = TRUE, lwd = 3, pal = viridis(15), color.interval = c(0,1))
cohorts(cmat_deut_WT, edata_WT_deut, lwd=3, pal = viridis(15), use.plot.bammdata=TRUE)
plot.bammdata(edata_WT_deut, labels = TRUE, lwd = 3, pal = viridis(15), color.interval = c(0,1))
plot.bammdata(edata_ortho_deut, labels = TRUE, legend = TRUE, , pal = viridis(15), color.interval = c(0,1), direction = "leftwards")
plot.bammdata(edata_ortho_deut, labels = TRUE, legend = TRUE, lwd = 3, pal = viridis(15), color.interval = c(0,1), direction = "leftwards")
#Analysis of rate shifts in the BAMM framework (Orthologs)
#Marginal shift probabilities
deuterostome_tre <- read.tree("Deuterostome_Species_TimeTree_no_polytomy.tre")
deuterostome_ladder_tree <- ladderize(deuterostome_tre, right = TRUE)
edata_ortho_deut <- getEventData(deuterostome_ladder_tree, eventdata = "deuterostome_ortho_mean_EpT_event_data.txt", type = "trait", burnin = 0.1)
plot.bammdata(edata_WT_deut, labels = TRUE, lwd = 3, pal = viridis(15), color.interval = c(0,0.25))
plot.bammdata(edata_ortho_deut, labels = TRUE, legend = TRUE, lwd = 3, pal = viridis(15), color.interval = c(0,0.25), direction = "leftwards")
?pdf
plot.bammdata(edata_WT_deut, labels = TRUE, lwd = 3, pal = viridis(15), color.interval = c(0,0.25))
plot.bammdata(edata_WT_deut, labels = FALSE, lwd = 3, pal = viridis(15), color.interval = c(0,0.25))
?svg
svg(plot.bammdata(edata_WT_deut, labels = TRUE, lwd = 3, pal = viridis(15), color.interval = c(0,0.25)), filename = "Deut_BAMM_WT.svg", width = 3.75, height = 5)
Deut_BAMM_Tree <- plot.bammdata(edata_WT_deut, labels = TRUE, lwd = 3, pal = viridis(15), color.interval = c(0,0.25))
dev.off()
svg(Deut_BAMM_Tree, filename = "Deut_BAMM_WT.svg", width = 3.75, height = 5)
svg(Deut_BAMM_Tree, filename = "Deut_BAMM_WT.svg", width = 3.75, height = 5, pointsize = 11)
svg(Deut_BAMM_Tree, filename = "Deut_BAMM_WT.svg", width = 3.75, height = 5, pointsize = 11)
svg(Deut_BAMM_Tree, filename = "Deut_BAMM_WT.svg", width = 4, height = 5, pointsize = 11)
svg(Deut_BAMM_Tree, filename = "Deut_BAMM_WT.svg", width = '4', height = 5, pointsize = 11)
svg(Deut_BAMM_Tree, filename = "Deut_BAMM_WT.svg", width = 3.25, height = 5, pointsize = 11)
setwd("/Volumes/GoogleDrive/My\ Drive/OrthoDB/Ortholog_Final_Files/Deuterostome_Complexity/Deuterostome_tree/Deuterostome_BAMM_Analysis")
svg(Deut_BAMM_Tree, filename = "Deut_BAMM_WT.svg", width = 3.25, height = 5, pointsize = 11)
setwd("/Volumes/GoogleDrive/My Drive/OrthoDB/Ortholog_Final_Files/Fungi_Complexity/Fungi_tree")
# Full dataset for fungis, the tree and the traits
fungi_full_traits <- read.csv("Fungi_gtf_classes_full_list_Evo_Rates.csv")
row.names(fungi_full_traits) <- fungi_full_traits$group
#Read trees and check tip labels
full_fungi_tree = ape::read.tree(file="fungi_class_pruned_no_polytomy.tre")
plot(full_fungi_tree)
full_fungi_tree$tip.label
fungi_full_traits$group
#Sanity check the names are the same between the traits and the tree
match(full_fungi_tree$tip.label,fungi_full_traits$group, nomatch = "not a match")
length(match(full_fungi_tree$tip.label,fungi_full_traits$group, nomatch = 0))
setwd("/Volumes/GoogleDrive/My Drive/OrthoDB/Ortholog_Final_Files/Drosophila_Complexity/Drosophila_tree/Drosophila_BAMM_Analysis")
#Sanity check for mcmc convergence
#Convergence WT
mcmcout <- read.csv("drosophila_WT_mean_EpT_mcmc_out.txt", header=T)
plot(mcmcout$logLik ~ mcmcout$generation)
burnstart <- floor(0.1 * nrow(mcmcout))
postburn <- mcmcout[burnstart:nrow(mcmcout), ]
effectiveSize(postburn$N_shifts)
effectiveSize(postburn$logLik)
#Convergence ortholog
ortho_mcmcout <- read.csv("drosophila_ortho_mean_EpT_mcmc_out.txt", header=T)
plot(ortho_mcmcout$logLik ~ ortho_mcmcout$generation)
ortho_burnstart <- floor(0.1 * nrow(ortho_mcmcout))
ortho_postburn <- ortho_mcmcout[burnstart:nrow(ortho_mcmcout), ]
effectiveSize(ortho_postburn$N_shifts)
effectiveSize(ortho_postburn$logLik)
#Analysis of rate shifts in the BAMM framework (WT)
#Marginal shift probabilities
drosophila_tre <- read.tree("drosophila_Species_TimeTree_no_polytomy.tre")
drosophila_ladder_tree <- ladderize(drosophila_tre, right = TRUE)
edata_WT_dros <- getEventData(drosophila_ladder_tree, eventdata = "drosophila_WT_mean_EpT_event_data.txt", type = "trait", burnin = 0.1)
edata_ortho_dros <- getEventData(drosophila_ladder_tree, eventdata = "drosophila_ortho_mean_EpT_event_data.txt", type = "trait", burnin = 0.1)
plot.bammdata(edata_WT_dros, labels = TRUE, legend = TRUE, color.interval = c(0,1), pal = viridis(15))
plot.bammdata(edata_ortho_dros, labels = TRUE, legend = TRUE, color.interval = c(0,1), direction = "leftwards", pal = viridis(15))
Deut_BAMM_Tree <- plot.bammdata(edata_WT_deut, labels = TRUE, lwd = 3, pal = viridis(15), color.interval = c(0,0.25))
plot.bammdata(edata_ortho_deut, labels = TRUE, legend = TRUE, lwd = 3, pal = viridis(15), color.interval = c(0,0.25), direction = "leftwards")
plot.bammdata(edata_ortho_deut, labels = TRUE, legend = TRUE, lwd = 3, pal = viridis(15), color.interval = c(0,1), direction = "leftwards")
plot.bammdata(edata_ortho_deut, labels = TRUE, legend = TRUE, lwd = 3, pal = viridis(15), color.interval = c(0,0.25), direction = "leftwards")
setwd("/Volumes/GoogleDrive/My Drive/OrthoDB/Ortholog_Final_Files/Plantae_Complexity/Plantae_tree/Plantae_BAMM_Analysis")
#Sanity check for mcmc convergence
#Convergence WT
mcmcout <- read.csv("plantae_WT_mean_EpT_mcmc_out.txt", header=T)
plot(mcmcout$logLik ~ mcmcout$generation)
burnstart <- floor(0.1 * nrow(mcmcout))
postburn <- mcmcout[burnstart:nrow(mcmcout), ]
effectiveSize(postburn$N_shifts)
effectiveSize(postburn$logLik)
#Convergence ortholog
ortho_mcmcout <- read.csv("plantae_ortho_mean_EpT_mcmc_out.txt", header=T)
plot(ortho_mcmcout$logLik ~ ortho_mcmcout$generation)
ortho_burnstart <- floor(0.1 * nrow(ortho_mcmcout))
ortho_postburn <- ortho_mcmcout[burnstart:nrow(ortho_mcmcout), ]
effectiveSize(ortho_postburn$N_shifts)
effectiveSize(ortho_postburn$logLik)
#Analysis of rate shifts in the BAMM framework (WT)
#Marginal shift probabilities
plantae_tre <- read.tree("Plantae_Species_Tree_list_no_polytomy.tre")
plantae_ladder_tree <- ladderize(plantae_tre, right = TRUE)
plot.bammdata(edata_WT_plant, labels = TRUE, legend = TRUE)
plot.bammdata(edata_WT_fungi, labels = TRUE, legend = TRUE)
fungi_WT_css <- credibleShiftSet(edata_WT_fungi, expectedNumberOfShifts = 1, threshold = 5)
plot.credibleshiftset(x = fungi_WT_css)
plot.bammdata(edata_WT_dros, labels = FALSE, lwd = 3, pal = viridis(15), color.interval = c(0,0.25))
plot.bammdata(edata_WT_dros, labels = FALSE, lwd = 3, pal = viridis(15))#, color.interval = c(0,0.25))
plot.bammdata(edata_WT_dros, labels = FALSE, lwd = 3, pal = viridis(15), color.interval = c(0,1))
plot.bammdata(edata_ortho_dros, labels = TRUE, legend = TRUE, color.interval = c(0,1), direction = "leftwards", pal = viridis(15))
plot.bammdata(edata_ortho_dros, labels = TRUE, legend = TRUE, direction = "leftwards", pal = viridis(15))
setwd("/Volumes/GoogleDrive/My\ Drive/OrthoDB/Ortholog_Final_Files/Deuterostome_Complexity/Deuterostome_tree/Deuterostome_BAMM_Analysis")
#Sanity check for mcmc convergence
#Convergence WT
mcmcout <- read.csv("deuterostome_WT_mean_EpT_mcmc_out.txt", header=T)
plot(mcmcout$logLik ~ mcmcout$generation)
burnstart <- floor(0.1 * nrow(mcmcout))
postburn <- mcmcout[burnstart:nrow(mcmcout), ]
effectiveSize(postburn$N_shifts)
effectiveSize(postburn$logLik)
#Convergence ortholog
ortho_mcmcout <- read.csv("deuterostome_ortho_mean_EpT_mcmc_out.txt", header=T)
plot(ortho_mcmcout$logLik ~ ortho_mcmcout$generation)
ortho_burnstart <- floor(0.1 * nrow(ortho_mcmcout))
ortho_postburn <- ortho_mcmcout[burnstart:nrow(ortho_mcmcout), ]
effectiveSize(ortho_postburn$N_shifts)
effectiveSize(ortho_postburn$logLik)
#Analysis of rate shifts in the BAMM framework (WT)
#Marginal shift probabilities
deuterostome_tre <- read.tree("Deuterostome_Species_TimeTree_no_polytomy.tre")
deuterostome_ladder_tree <- ladderize(deuterostome_tre, right = TRUE)
edata_WT_deut <- getEventData(deuterostome_ladder_tree, eventdata = "deuterostome_WT_mean_EpT_event_data.txt", type = "trait", burnin = 0.1)
marg_probs_WT_deut <- marginalShiftProbsTree(edata_WT_deut)
plot.phylo(deuterostome_tre)
plot.bammdata(edata_WT_deut, labels = FALSE, lwd = 3, pal = viridis(15), color.interval = c(0,0.25))
summary(edata_WT_deut)
deuterostome_WT_css <- credibleShiftSet(edata_WT_deut, expectedNumberOfShifts = 1, threshold = 5)
plot.credibleshiftset(x = deuterostome_WT_css)
#Analysis of rate shifts in the BAMM framework (Orthologs)
#Marginal shift probabilities
deuterostome_tre <- read.tree("Deuterostome_Species_TimeTree_no_polytomy.tre")
deuterostome_ladder_tree <- ladderize(deuterostome_tre, right = TRUE)
edata_ortho_deut <- getEventData(deuterostome_ladder_tree, eventdata = "deuterostome_ortho_mean_EpT_event_data.txt", type = "trait", burnin = 0.1)
marg_probs_ortho_deut <- marginalShiftProbsTree(edata_ortho_deut)
plot.phylo(marg_probs_ortho_deut)
plot.bammdata(edata_ortho_deut, labels = TRUE, legend = TRUE, lwd = 3, pal = viridis(15), color.interval = c(0,0.25), direction = "leftwards")
summary(edata_ortho_deut)
deuterostome_ortho_css <- credibleShiftSet(edata_ortho_deut, expectedNumberOfShifts = 1, threshold = 5)
plot.credibleshiftset(x = deuterostome_ortho_css)
plot.credibleshiftset(x = deuterostome_WT_css)
plot.bammdata(edata_WT_deut, labels = FALSE, lwd = 3, pal = viridis(15), color.interval = c(0,0.48))
plot.bammdata(edata_ortho_deut, labels = TRUE, legend = TRUE, lwd = 3, pal = viridis(15), color.interval = c(0,0.3), direction = "leftwards")
plot.bammdata(edata_WT_deut, labels = TRUE, lwd = 3, pal = viridis(15))
plot.bammdata(edata_WT_deut, labels = TRUE, legend = TRUE, lwd = 3, pal = viridis(15))
plot.bammdata(edata_ortho_deut, labels = TRUE, legend = TRUE, lwd = 3, pal = viridis(15), color.interval = c(0,0.3), direction = "leftwards")
plot.bammdata(edata_ortho_deut, labels = TRUE, legend = TRUE, lwd = 3, pal = viridis(15), direction = "leftwards")
plot.bammdata(edata_WT_deut, labels = FALSE, lwd = 3, pal = viridis(15), color.interval = c(0,0.21))
plot.bammdata(edata_ortho_deut, labels = TRUE, legend = TRUE, lwd = 3, pal = viridis(15), color.interval = c(0,0.21), direction = "leftwards")
setwd("/Volumes/GoogleDrive/My Drive/OrthoDB/Ortholog_Final_Files/Drosophila_Complexity/Drosophila_tree/Drosophila_BAMM_Analysis")
#Sanity check for mcmc convergence
#Convergence WT
mcmcout <- read.csv("drosophila_WT_mean_EpT_mcmc_out.txt", header=T)
plot(mcmcout$logLik ~ mcmcout$generation)
burnstart <- floor(0.1 * nrow(mcmcout))
postburn <- mcmcout[burnstart:nrow(mcmcout), ]
effectiveSize(postburn$N_shifts)
effectiveSize(postburn$logLik)
#Convergence ortholog
ortho_mcmcout <- read.csv("drosophila_ortho_mean_EpT_mcmc_out.txt", header=T)
plot(ortho_mcmcout$logLik ~ ortho_mcmcout$generation)
ortho_burnstart <- floor(0.1 * nrow(ortho_mcmcout))
ortho_postburn <- ortho_mcmcout[burnstart:nrow(ortho_mcmcout), ]
effectiveSize(ortho_postburn$N_shifts)
effectiveSize(ortho_postburn$logLik)
#Analysis of rate shifts in the BAMM framework (WT)
#Marginal shift probabilities
drosophila_tre <- read.tree("drosophila_Species_TimeTree_no_polytomy.tre")
drosophila_ladder_tree <- ladderize(drosophila_tre, right = TRUE)
edata_WT_dros <- getEventData(drosophila_ladder_tree, eventdata = "drosophila_WT_mean_EpT_event_data.txt", type = "trait", burnin = 0.1)
marg_probs_WT_dros <- marginalShiftProbsTree(edata_WT_dros)
plot.phylo(marg_probs_WT_dros)
plot.bammdata(edata_WT_dros, labels = TRUE, lwd = 3, pal = viridis(15), legend = TRUE)
drosophila_WT_css <- credibleShiftSet(edata_WT_dros, expectedNumberOfShifts = 1, threshold = 5)
plot.credibleshiftset(x = drosophila_WT_css)
#Analysis of rate shifts in the BAMM framework (Orthologs)
#Marginal shift probabilities
drosophila_tre <- read.tree("drosophila_Species_TimeTree_no_polytomy.tre")
drosophila_ladder_tree <- ladderize(drosophila_tre, right = TRUE)
edata_ortho_dros <- getEventData(drosophila_ladder_tree, eventdata = "drosophila_ortho_mean_EpT_event_data.txt", type = "trait", burnin = 0.1)
marg_probs_ortho_dros <- marginalShiftProbsTree(edata_ortho_dros)
plot.bammdata(edata_ortho_dros, labels = TRUE, legend = TRUE, direction = "leftwards", pal = viridis(15))
plot.bammdata(edata_ortho_dros, labels = TRUE, legend = TRUE, lwd = 3, direction = "leftwards", pal = viridis(15))
drosophila_WT_css <- credibleShiftSet(edata_ortho_dros, expectedNumberOfShifts = 1, threshold = 5)
plot.credibleshiftset(x = drosophila_WT_css)
setwd("/Volumes/GoogleDrive/My Drive/OrthoDB/Ortholog_Final_Files/Plantae_Complexity/Plantae_tree/Plantae_BAMM_Analysis")
#Sanity check for mcmc convergence
#Convergence WT
mcmcout <- read.csv("plantae_WT_mean_EpT_mcmc_out.txt", header=T)
plot(mcmcout$logLik ~ mcmcout$generation)
burnstart <- floor(0.1 * nrow(mcmcout))
postburn <- mcmcout[burnstart:nrow(mcmcout), ]
effectiveSize(postburn$N_shifts)
effectiveSize(postburn$logLik)
#Convergence ortholog
ortho_mcmcout <- read.csv("plantae_ortho_mean_EpT_mcmc_out.txt", header=T)
plot(ortho_mcmcout$logLik ~ ortho_mcmcout$generation)
ortho_burnstart <- floor(0.1 * nrow(ortho_mcmcout))
ortho_postburn <- ortho_mcmcout[burnstart:nrow(ortho_mcmcout), ]
effectiveSize(ortho_postburn$N_shifts)
effectiveSize(ortho_postburn$logLik)
#Analysis of rate shifts in the BAMM framework (WT)
#Marginal shift probabilities
plantae_tre <- read.tree("Plantae_Species_Tree_list_no_polytomy.tre")
plantae_ladder_tree <- ladderize(plantae_tre, right = TRUE)
edata_WT_plant <- getEventData(plantae_ladder_tree, eventdata = "plantae_WT_mean_EpT_event_data.txt", type = "trait", burnin = 0.1)
marg_probs_WT_plant <- marginalShiftProbsTree(edata_WT_plant)
plot.phylo(marg_probs_WT_plant)
plot.bammdata(edata_WT_plant, labels = TRUE, legend = TRUE, lwd = 3, direction = "leftwards", pal = viridis(15))
plot.bammdata(edata_ortho_plant, labels = TRUE, legend = TRUE, lwd = 3, direction = "leftwards", pal = viridis(15))
edata_ortho_plant <- getEventData(plantae_ladder_tree, eventdata = "plantae_WT_mean_EpT_event_data.txt", type = "trait", burnin = 0.1)
marg_probs_ortho_plant <- marginalShiftProbsTree(edata_ortho_plant)
plot.phylo(marg_probs_ortho_plant)
plot.bammdata(edata_ortho_plant, labels = TRUE, legend = TRUE, lwd = 3, direction = "leftwards", pal = viridis(15))
edata_ortho_plant <- getEventData(plantae_ladder_tree, eventdata = "plantae_ortho_mean_EpT_event_data.txt", type = "trait", burnin = 0.1)
marg_probs_ortho_plant <- marginalShiftProbsTree(edata_ortho_plant)
plot.phylo(marg_probs_ortho_plant)
plot.phylo(marg_probs_WT_plant)
plot.bammdata(edata_WT_plant, labels = TRUE, legend = TRUE, lwd = 3, direction = "leftwards", pal = viridis(15))
plot.bammdata(edata_ortho_plant, labels = TRUE, legend = TRUE, lwd = 3, direction = "leftwards", pal = viridis(15))
plot.bammdata(edata_WT_plant, labels = TRUE, legend = TRUE, lwd = 3, pal = viridis(15))
plot.bammdata(edata_ortho_plant, labels = TRUE, legend = TRUE, lwd = 3, direction = "leftwards", pal = viridis(15))
plot.bammdata(edata_WT_plant, labels = TRUE, legend = FALSE, color.interval = c(0,0.21), pal = viridis(15))
plot.bammdata(edata_ortho_plant, labels = TRUE, legend = TRUE, lwd = 3, direction = "leftwards", color.interval = c(0,0.21), pal = viridis(15))
plot.bammdata(edata_WT_plant, labels = TRUE, legend = FALSE, lwd = 3, color.interval = c(0,0.21), pal = viridis(15))
plot.bammdata(edata_ortho_plant, labels = TRUE, legend = TRUE, lwd = 3, direction = "leftwards", color.interval = c(0,0.21), pal = viridis(15))
plant_WT_css <- credibleShiftSet(edata_WT_plant, expectedNumberOfShifts = 1, threshold = 5)
plot.credibleshiftset(x = plant_WT_css)
plant_ortho_css <- credibleShiftSet(edata_ortho_plant, expectedNumberOfShifts = 1, threshold = 5)
plot.credibleshiftset(x = plant_ortho_css)
setwd("/Volumes/GoogleDrive/My Drive/OrthoDB/Ortholog_Final_Files/Fungi_Complexity/Fungi_tree/Fungi_BAMM_Analysis")
#Sanity check for mcmc convergence
#Convergence WT
mcmcout <- read.csv("fungi_WT_mean_EpT_mcmc_out.txt", header=T)
plot(mcmcout$logLik ~ mcmcout$generation)
burnstart <- floor(0.1 * nrow(mcmcout))
postburn <- mcmcout[burnstart:nrow(mcmcout), ]
effectiveSize(postburn$N_shifts)
effectiveSize(postburn$logLik)
#Convergence ortholog
ortho_mcmcout <- read.csv("fungi_ortho_mean_EpT_mcmc_out.txt", header=T)
plot(ortho_mcmcout$logLik ~ ortho_mcmcout$generation)
ortho_burnstart <- floor(0.1 * nrow(ortho_mcmcout))
ortho_postburn <- ortho_mcmcout[burnstart:nrow(ortho_mcmcout), ]
effectiveSize(ortho_postburn$N_shifts)
effectiveSize(ortho_postburn$logLik)
#Analysis of rate shifts in the BAMM framework (WT)
#Marginal shift probabilities
fungi_tre <- read.tree("fungi_class_pruned_no_polytomy.tre")
fungi_ladder_tree <- ladderize(fungi_tre, right = TRUE)
edata_WT_fungi <- getEventData(fungi_ladder_tree, eventdata = "fungi_WT_mean_EpT_event_data.txt", type = "trait", burnin = 0.1)
marg_probs_WT_fungi <- marginalShiftProbsTree(edata_WT_fungi)
plot.phylo(marg_probs_WT_fungi)
plot.phylo(marg_probs_WT_fungi)
plot.bammdata(edata_WT_fungi, labels = TRUE, legend = TRUE, lwd = 3, pal = viridis(15))
edata_ortho_fungi <- getEventData(fungi_ladder_tree, eventdata = "fungi_ortho_mean_EpT_event_data.txt", type = "trait", burnin = 0.1)
marg_probs_ortho_fungi <- marginalShiftProbsTree(edata_ortho_fungi)
plot.phylo(marg_probs_ortho_fungi)
plot.bammdata(edata_ortho_fungi, labels = TRUE, legend = TRUE, lwd = 3, pal = viridis(15))
fungi_WT_css <- credibleShiftSet(edata_WT_fungi, expectedNumberOfShifts = 1, threshold = 5)
plot.credibleshiftset(x = fungi_WT_css)
fungi_ortho_css <- credibleShiftSet(edata_ortho_fungi, expectedNumberOfShifts = 1, threshold = 5)
plot.credibleshiftset(x = fungi_ortho_css)
deuterostome_WT_mean_EpT <- plot.bammdata(edata_WT_deut, labels = FALSE, lwd = 3, pal = viridis(15), color.interval = c(0,0.21))
plot.bammdata(edata_WT_deut, labels = TRUE, legend = TRUE, lwd = 3, pal = viridis(15))
deuterostome_WT_mean_EpT <- plot.bammdata(edata_WT_deut, labels = FALSE, lwd = 3, pal = viridis(15), color.interval = c(0,0.21))
pdf(deuterostome_WT_mean_EpT, file = "deuterostome_WT_mean_EpT_BAMM.pdf", width = 2, height = 5)
setwd("/Volumes/GoogleDrive/My\ Drive/OrthoDB/Ortholog_Final_Files/Deuterostome_Complexity/Deuterostome_tree/Deuterostome_BAMM_Analysis")
pdf(deuterostome_WT_mean_EpT, file = "deuterostome_WT_mean_EpT_BAMM.pdf", width = 2, height = 5)
pdf(deuterostome_WT_mean_EpT, file = "deuterostome_WT_mean_EpT_BAMM.pdf", width = 2, height = 5)
?pdf
pdf(file = "deuterostome_WT_mean_EpT_BAMM.pdf", width = 2, height = 5)
print(deuterostome_WT_mean_EpT)
dev.off()
plot.bammdata(edata_WT_deut, labels = FALSE, lwd = 3, pal = viridis(15), color.interval = c(0,0.21))
plot.bammdata(edata_ortho_deut, labels = TRUE, legend = TRUE, lwd = 3, pal = viridis(15), color.interval = c(0,0.21), direction = "leftwards")
plot.bammdata(edata_WT_dros, labels = FALSE, lwd = 3, pal = viridis(15), color.interval = c(0,0.92))
plot.bammdata(edata_ortho_dros, labels = TRUE, legend = TRUE, color.interval = c(0,0.92), direction = "leftwards", pal = viridis(15))
plot.bammdata(edata_ortho_dros, labels = TRUE, legend = TRUE, lwd = 3, color.interval = c(0,0.92), direction = "leftwards", pal = viridis(15))
plot.bammdata(edata_WT_plant, labels = TRUE, legend = FALSE, lwd = 3, color.interval = c(0,0.21), pal = viridis(15))
plot.bammdata(edata_WT_plant, labels = FALSE, legend = FALSE, lwd = 3, color.interval = c(0,0.21), pal = viridis(15))
plot.bammdata(edata_ortho_plant, labels = TRUE, legend = TRUE, lwd = 3, direction = "leftwards", color.interval = c(0,0.21), pal = viridis(15))
plot.bammdata(edata_WT_fungi, labels = TRUE, legend = FALSE, lwd = 3, color.interval = c(0,0.64), pal = viridis(15))
plot.bammdata(edata_WT_fungi, labels = FALSE, legend = FALSE, lwd = 3, color.interval = c(0,0.64), pal = viridis(15))
plot.bammdata(edata_ortho_fungi, labels = TRUE, legend = FALSE, lwd = 3, color.interval = c(0,0.64), pal = viridis(15))
plot.bammdata(edata_ortho_fungi, llabels = TRUE, legend = TRUE, lwd = 3, direction = "leftwards", color.interval = c(0,0.64), pal = viridis(15))
plot.bammdata(edata_ortho_fungi, labels = TRUE, legend = TRUE, lwd = 3, direction = "leftwards", color.interval = c(0,0.64), pal = viridis(15))
#Temp pdf
plot.bammdata(edata_WT_fungi, labels = TRUE, legend = TRUE, lwd = 3, color.interval = c(0,0.64), pal = viridis(15))
#Temp pdf
plot.bammdata(edata_WT_fungi, labels = TRUE, legend = TRUE, lwd = 3, color.interval = c(0,0.64), pal = viridis(15))
#Temp pdf
plot.bammdata(edata_WT_fungi, labels = TRUE, legend = TRUE, lwd = 3, color.interval = c(0,0.64), pal = viridis(15))
plot.bammdata(edata_WT_fungi, labels = FALSE, legend = FALSE, lwd = 3, color.interval = c(0,0.64), pal = viridis(15))
plot.bammdata(edata_ortho_fungi, labels = TRUE, legend = TRUE, lwd = 3, direction = "leftwards", color.interval = c(0,0.64), pal = viridis(15))
